state = [2.13369903101225,1.27349492703605,0.984063696855853,-0.179215769903801,1.73719032324708,1.70757037996533,0.133398260790635,1.67328876751205,1.27200818354014,1.64922663477975,0.367888548946426,0.997574628418356,0.603118567886304,0.333768817685150,-2.55018601846453,1.05859399296232,-8.82104509912078,1.47615919025960,-10.6583044850888,0.222339493953958,1.38747644569538,0.421404013915391,-0.739250160491431,1.14601726128103,-0.208446513159746,0.478699778630990,2.80155813751302,-8.82553353358210,-8.18644284554309,3.08790579539640,1.17278923966707,-4.39759752650522,1.81117014679610,-1.06540689226834,1.55648343024671,1.48285379793586,1.91158265671989,0.962711499341673,0.883072767271662,2.06049245850919,1.67517939312223,1.22772588899629,1.38837772404084,1.32869086244247,1.94998523549283,1.11474607517181,1.19365545015335,1.49852570605482]';
x = state(1:8);
x_dot = state(9:16);
y = state(17:24);
y_dot = state(25:32);
theta = state(33:40);
theta_dot = state(41:48);

load('PhiToU13.mat');

[ xf,xf_dot,yf,yf_dot ] = HeelAndToe( x,x_dot,y,y_dot,theta,theta_dot );

[ Fgx,Fgy ] = GroundReactionForce( x,theta,xf,xf_dot,yf,yf_dot );

[ phi,phi_dot ] = GlobalAngle( x,x_dot,y,y_dot,theta,Fgy );

[ Sron,Sroff,Slon,Sloff,Sg,Srst,Slst ] = GlobalState( Fgy,xf,yf,phi );

for ii = 1 : 6
    if Sg(ii) == 1
        phitou13 = PhiToU13{ii};
        u13 = (FindFunctionValue(phitou13(:,1),phitou13(:,2),phi));
    end
end
